import { useState, useEffect } from "react";
import { useRoute, useLocation } from "wouter";
import { useQuery, useMutation } from "@tanstack/react-query";
import { useForm } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import { z } from "zod";
import { PartyEnum, Politician } from "@shared/schema";
import { apiRequest, queryClient } from "@/lib/queryClient";
import { useToast } from "@/hooks/use-toast";
import AdminLayout from "@/layout/AdminLayout";
import { Button } from "@/components/ui/button";
import { Card } from "@/components/ui/card";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import {
  Form,
  FormControl,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from "@/components/ui/form";
import { Input } from "@/components/ui/input";
import { Textarea } from "@/components/ui/textarea";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { ArrowLeft } from "lucide-react";

// Form schema
const politicianFormSchema = z.object({
  name: z.string().min(2, "Name must be at least 2 characters"),
  party: PartyEnum,
  district: z.string().min(2, "District must be at least 2 characters"),
  bio: z.string().optional(),
  firstElected: z.string().optional(),
  profileImageUrl: z.string().url().optional().or(z.literal("")),
  manifestoPoint1: z.string().optional(),
  manifestoPoint2: z.string().optional(),
  manifestoPoint3: z.string().optional(),
  manifestoPoint4: z.string().optional(),
  manifestoPoint5: z.string().optional(),
  // Promise fields
  promise1Title: z.string().optional(),
  promise1Description: z.string().optional(),
  promise1Status: z.enum(["Fulfilled", "InProgress", "Unfulfilled"]).optional(),
  promise2Title: z.string().optional(),
  promise2Description: z.string().optional(),
  promise2Status: z.enum(["Fulfilled", "InProgress", "Unfulfilled"]).optional(),
  // Voting record fields
  bill1Title: z.string().optional(),
  bill1Description: z.string().optional(),
  bill1Vote: z.enum(["For", "Against", "Abstained", "Absent"]).optional(),
  bill2Title: z.string().optional(),
  bill2Description: z.string().optional(),
  bill2Vote: z.enum(["For", "Against", "Abstained", "Absent"]).optional(),
});

type PoliticianFormValues = z.infer<typeof politicianFormSchema>;

const AdminEditPolitician = () => {
  const [, params] = useRoute<{ id: string }>("/admin/politicians/edit/:id");
  const politicianId = params?.id ? parseInt(params.id) : 0;
  const [, navigate] = useLocation();
  const { toast } = useToast();
  const [activeTab, setActiveTab] = useState("basic-information");

  // Fetch politician data
  const { data: politicianData, isLoading, error } = useQuery<{ politician: Politician }>({
    queryKey: [`/api/politicians/${politicianId}`],
    enabled: politicianId > 0,
  });

  // Form setup
  const form = useForm<PoliticianFormValues>({
    resolver: zodResolver(politicianFormSchema),
    defaultValues: {
      name: "",
      party: "Democratic",
      district: "",
      bio: "",
      firstElected: "",
      profileImageUrl: "",
      manifestoPoint1: "",
      manifestoPoint2: "",
      manifestoPoint3: "",
      manifestoPoint4: "",
      manifestoPoint5: "",
      // Promise fields
      promise1Title: "",
      promise1Description: "",
      promise1Status: "Unfulfilled",
      promise2Title: "",
      promise2Description: "",
      promise2Status: "Unfulfilled",
      // Voting record fields
      bill1Title: "",
      bill1Description: "",
      bill1Vote: "For",
      bill2Title: "",
      bill2Description: "",
      bill2Vote: "For",
    },
  });

  // Fetch promises and voting records
  const { data: promisesData } = useQuery<{ promises: any[] }>({
    queryKey: [`/api/politicians/${politicianId}/promises`],
    enabled: politicianId > 0,
  });
  
  const { data: votingRecordsData } = useQuery<{ votingRecords: any[], bills: any[] }>({
    queryKey: [`/api/politicians/${politicianId}/voting-records`],
    enabled: politicianId > 0,
  });

  // Set form values when politician data is loaded
  useEffect(() => {
    if (politicianData?.politician) {
      const politician = politicianData.politician;
      
      // Format the date for the input field (YYYY-MM-DD)
      const formattedDate = politician.firstElected 
        ? new Date(politician.firstElected).toISOString().split('T')[0] 
        : "";
      
      // Prepare the form data with basic info
      const formData: any = {
        name: politician.name,
        party: politician.party as any,
        district: politician.district,
        bio: politician.bio || "",
        firstElected: formattedDate,
        profileImageUrl: politician.profileImageUrl || "",
        manifestoPoint1: politician.manifestoPoint1 || "",
        manifestoPoint2: politician.manifestoPoint2 || "",
        manifestoPoint3: politician.manifestoPoint3 || "",
        manifestoPoint4: politician.manifestoPoint4 || "",
        manifestoPoint5: politician.manifestoPoint5 || "",
      };
      
      // Add promise data if available
      if (promisesData?.promises && promisesData.promises.length > 0) {
        const promises = promisesData.promises;
        if (promises[0]) {
          formData.promise1Title = promises[0].title || "";
          formData.promise1Description = promises[0].description || "";
          formData.promise1Status = promises[0].status || "Unfulfilled";
        }
        
        if (promises[1]) {
          formData.promise2Title = promises[1].title || "";
          formData.promise2Description = promises[1].description || "";
          formData.promise2Status = promises[1].status || "Unfulfilled";
        }
      }
      
      // Add voting record data if available
      if (votingRecordsData?.votingRecords && votingRecordsData.bills) {
        const records = votingRecordsData.votingRecords;
        const bills = votingRecordsData.bills;
        
        if (records[0] && bills[records[0].billId]) {
          const bill = bills[records[0].billId];
          formData.bill1Title = bill.title || "";
          formData.bill1Description = bill.description || "";
          formData.bill1Vote = records[0].vote || "For";
        }
        
        if (records[1] && bills[records[1].billId]) {
          const bill = bills[records[1].billId];
          formData.bill2Title = bill.title || "";
          formData.bill2Description = bill.description || "";
          formData.bill2Vote = records[1].vote || "For";
        }
      }
      
      // Reset the form with all data
      form.reset(formData);
    }
  }, [politicianData, promisesData, votingRecordsData, form]);

  // Update politician mutation
  const updatePoliticianMutation = useMutation({
    mutationFn: (data: PoliticianFormValues) => 
      apiRequest("PUT", `/api/admin/politicians/${politicianId}`, data),
    onSuccess: () => {
      toast({
        title: "Success",
        description: "Politician updated successfully",
      });
      queryClient.invalidateQueries({ queryKey: ["/api/politicians"] });
      queryClient.invalidateQueries({ queryKey: [`/api/politicians/${politicianId}`] });
      navigate("/admin/politicians");
    },
    onError: (error) => {
      toast({
        title: "Error",
        description: "Failed to update politician. Please try again.",
        variant: "destructive",
      });
    },
  });

  // Form submission handler
  const onSubmit = (data: PoliticianFormValues) => {
    // Include promise data
    const promises = [];
    
    if (form.getValues("promise1Title")) {
      promises.push({
        title: form.getValues("promise1Title"),
        description: form.getValues("promise1Description") || "",
        status: form.getValues("promise1Status") || "Unfulfilled",
        politicianId
      });
    }
    
    if (form.getValues("promise2Title")) {
      promises.push({
        title: form.getValues("promise2Title"),
        description: form.getValues("promise2Description") || "",
        status: form.getValues("promise2Status") || "Unfulfilled",
        politicianId
      });
    }
    
    // Include voting records
    const votingRecords = [];
    
    if (form.getValues("bill1Title")) {
      votingRecords.push({
        billTitle: form.getValues("bill1Title"),
        billDescription: form.getValues("bill1Description") || "",
        vote: form.getValues("bill1Vote") || "For",
        politicianId
      });
    }
    
    if (form.getValues("bill2Title")) {
      votingRecords.push({
        billTitle: form.getValues("bill2Title"),
        billDescription: form.getValues("bill2Description") || "",
        vote: form.getValues("bill2Vote") || "For",
        politicianId
      });
    }
    
    // Submit all data together
    updatePoliticianMutation.mutate({
      ...data,
      promises,
      votingRecords
    });
  };

  const handleCancel = () => {
    navigate("/admin/politicians");
  };

  if (isLoading) {
    return (
      <AdminLayout title="Edit Politician">
        <div className="flex justify-center items-center min-h-[60vh]">
          <div className="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"></div>
        </div>
      </AdminLayout>
    );
  }

  if (error || !politicianData) {
    return (
      <AdminLayout title="Edit Politician">
        <div className="p-8 text-center bg-red-50 rounded-lg border border-red-100">
          <h2 className="text-xl font-bold text-red-800 mb-2">Error Loading Politician</h2>
          <p className="text-red-600 mb-4">
            We couldn't load this politician's data. Please try again later.
          </p>
          <Button onClick={() => navigate("/admin/politicians")}>Return to Politicians</Button>
        </div>
      </AdminLayout>
    );
  }

  const politician = politicianData.politician;

  return (
    <AdminLayout title={`Edit ${politician.name}`}>
      <div className="flex items-center mb-6">
        <Button variant="ghost" size="sm" onClick={() => navigate("/admin/politicians")} className="mr-2">
          <ArrowLeft className="h-4 w-4 mr-1" />
        </Button>
        <h2 className="text-2xl font-bold text-gray-900">Edit {politician.name}</h2>
      </div>

      <Card className="overflow-hidden shadow bg-white">
        <Form {...form}>
          <form onSubmit={form.handleSubmit(onSubmit)}>
            <Tabs value={activeTab} onValueChange={setActiveTab}>
              <div className="border-b">
                <TabsList className="m-0 p-0 border-b-0 rounded-none bg-transparent h-12">
                  <TabsTrigger 
                    value="basic-information" 
                    className="data-[state=active]:border-b-2 data-[state=active]:border-primary-600 data-[state=active]:text-primary-600 rounded-none h-12 text-sm"
                  >
                    Basic Information
                  </TabsTrigger>
                  <TabsTrigger 
                    value="manifesto" 
                    className="data-[state=active]:border-b-2 data-[state=active]:border-primary-600 data-[state=active]:text-primary-600 rounded-none h-12 text-sm"
                  >
                    Manifesto
                  </TabsTrigger>
                  <TabsTrigger 
                    value="voting" 
                    className="data-[state=active]:border-b-2 data-[state=active]:border-primary-600 data-[state=active]:text-primary-600 rounded-none h-12 text-sm"
                  >
                    Voting & Promises
                  </TabsTrigger>
                </TabsList>
              </div>

              <TabsContent value="basic-information" className="p-6">
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <FormField
                    control={form.control}
                    name="name"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Full Name</FormLabel>
                        <FormControl>
                          <Input {...field} />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />

                  <FormField
                    control={form.control}
                    name="party"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Political Party</FormLabel>
                        <Select
                          onValueChange={field.onChange}
                          defaultValue={field.value}
                        >
                          <FormControl>
                            <SelectTrigger>
                              <SelectValue placeholder="Select party" />
                            </SelectTrigger>
                          </FormControl>
                          <SelectContent>
                            <SelectItem value="Democratic">Democratic</SelectItem>
                            <SelectItem value="Republican">Republican</SelectItem>
                            <SelectItem value="Independent">Independent</SelectItem>
                          </SelectContent>
                        </Select>
                        <FormMessage />
                      </FormItem>
                    )}
                  />

                  <FormField
                    control={form.control}
                    name="district"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>District</FormLabel>
                        <FormControl>
                          <Input {...field} />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />

                  <FormField
                    control={form.control}
                    name="firstElected"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>First Elected</FormLabel>
                        <FormControl>
                          <Input type="date" {...field} />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />

                  <div className="md:col-span-2">
                    <FormField
                      control={form.control}
                      name="bio"
                      render={({ field }) => (
                        <FormItem>
                          <FormLabel>Bio</FormLabel>
                          <FormControl>
                            <Textarea
                              rows={4}
                              {...field}
                            />
                          </FormControl>
                          <FormMessage />
                        </FormItem>
                      )}
                    />
                  </div>

                  <div className="md:col-span-2">
                    <FormField
                      control={form.control}
                      name="profileImageUrl"
                      render={({ field }) => (
                        <FormItem>
                          <FormLabel>Profile Photo URL</FormLabel>
                          <FormControl>
                            <Input {...field} />
                          </FormControl>
                          <FormMessage />
                        </FormItem>
                      )}
                    />
                  </div>
                </div>
              </TabsContent>

              <TabsContent value="manifesto" className="p-6">
                <div className="space-y-6">
                  <div>
                    <h3 className="text-lg font-medium leading-6 text-gray-900 mb-4">Key Manifesto Highlights</h3>
                    <p className="text-sm text-gray-500 mb-6">Add up to 5 key points from the politician's manifesto</p>
                  </div>
                  
                  <FormField
                    control={form.control}
                    name="manifestoPoint1"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Point 1</FormLabel>
                        <FormControl>
                          <Textarea 
                            placeholder="Enter manifesto point"
                            rows={2}
                            {...field} 
                          />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />
                  
                  <FormField
                    control={form.control}
                    name="manifestoPoint2"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Point 2</FormLabel>
                        <FormControl>
                          <Textarea 
                            placeholder="Enter manifesto point"
                            rows={2}
                            {...field} 
                          />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />
                  
                  <FormField
                    control={form.control}
                    name="manifestoPoint3"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Point 3</FormLabel>
                        <FormControl>
                          <Textarea 
                            placeholder="Enter manifesto point"
                            rows={2}
                            {...field} 
                          />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />
                  
                  <FormField
                    control={form.control}
                    name="manifestoPoint4"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Point 4</FormLabel>
                        <FormControl>
                          <Textarea 
                            placeholder="Enter manifesto point"
                            rows={2}
                            {...field} 
                          />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />
                  
                  <FormField
                    control={form.control}
                    name="manifestoPoint5"
                    render={({ field }) => (
                      <FormItem>
                        <FormLabel>Point 5</FormLabel>
                        <FormControl>
                          <Textarea 
                            placeholder="Enter manifesto point"
                            rows={2}
                            {...field} 
                          />
                        </FormControl>
                        <FormMessage />
                      </FormItem>
                    )}
                  />
                </div>
              </TabsContent>

              <TabsContent value="voting" className="p-6">
                <div className="space-y-8">
                  {/* Voting Record Section */}
                  <div>
                    <h3 className="text-lg font-medium leading-6 text-gray-900 mb-4">Voting Record</h3>
                    <p className="text-sm text-gray-500 mb-6">Add up to 4 significant votes</p>
                    
                    {/* Voting Record 1 */}
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                      <div className="md:col-span-2">
                        <div className="form-control w-full">
                          <label className="block text-sm font-medium mb-1">Bill</label>
                          <input
                            type="text"
                            placeholder="e.g. Climate Protection Act"
                            className="w-full p-2 border border-gray-300 rounded"
                            value={form.getValues("bill1Title") || ""}
                            onChange={(e) => form.setValue("bill1Title", e.target.value)}
                          />
                        </div>
                      </div>
                      <div>
                        <div className="form-control w-full">
                          <label className="block text-sm font-medium mb-1">Vote</label>
                          <select
                            className="w-full p-2 border border-gray-300 rounded"
                            value={form.getValues("bill1Vote") || "For"}
                            onChange={(e) => form.setValue("bill1Vote", e.target.value as any)}
                          >
                            <option value="For">For</option>
                            <option value="Against">Against</option>
                            <option value="Abstained">Abstained</option>
                            <option value="Absent">Absent</option>
                          </select>
                        </div>
                      </div>
                      <div className="md:col-span-4">
                        <div className="form-control w-full">
                          <label className="block text-sm font-medium mb-1">Description</label>
                          <textarea
                            placeholder="Brief description of the bill"
                            className="w-full p-2 border border-gray-300 rounded"
                            rows={2}
                            value={form.getValues("bill1Description") || ""}
                            onChange={(e) => form.setValue("bill1Description", e.target.value)}
                          />
                        </div>
                      </div>
                    </div>

                    {/* Voting Record 2 */}
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                      <div className="md:col-span-2">
                        <div className="form-control w-full">
                          <label className="block text-sm font-medium mb-1">Bill</label>
                          <input
                            type="text"
                            placeholder="e.g. Infrastructure Funding Bill" 
                            className="w-full p-2 border border-gray-300 rounded"
                            value={form.getValues("bill2Title") || ""}
                            onChange={(e) => form.setValue("bill2Title", e.target.value)}
                          />
                        </div>
                      </div>
                      <div>
                        <div className="form-control w-full">
                          <label className="block text-sm font-medium mb-1">Vote</label>
                          <select
                            className="w-full p-2 border border-gray-300 rounded"
                            value={form.getValues("bill2Vote") || "For"}
                            onChange={(e) => form.setValue("bill2Vote", e.target.value as any)}
                          >
                            <option value="For">For</option>
                            <option value="Against">Against</option>
                            <option value="Abstained">Abstained</option>
                            <option value="Absent">Absent</option>
                          </select>
                        </div>
                      </div>
                      <div className="md:col-span-4">
                        <div className="form-control w-full">
                          <label className="block text-sm font-medium mb-1">Description</label>
                          <textarea
                            placeholder="Brief description of the bill" 
                            className="w-full p-2 border border-gray-300 rounded" 
                            rows={2}
                            value={form.getValues("bill2Description") || ""}
                            onChange={(e) => form.setValue("bill2Description", e.target.value)}
                          />
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Promises vs. Reality Section */}
                  <div>
                    <h3 className="text-lg font-medium leading-6 text-gray-900 mb-4">Promises vs. Reality</h3>
                    <p className="text-sm text-gray-500 mb-6">Compare campaign promises with actual performance</p>
                    
                    {/* Promise 1 */}
                    <div className="mb-6">
                      <div className="form-control w-full mb-2">
                        <label className="block text-sm font-medium mb-1">Promise</label>
                        <textarea 
                          placeholder="e.g. Will reduce taxes by 10%" 
                          className="w-full p-2 border border-gray-300 rounded" 
                          rows={2}
                          value={form.getValues("promise1Title") || ""}
                          onChange={(e) => form.setValue("promise1Title", e.target.value)}
                        />
                      </div>
                      <div className="form-control w-full mb-2">
                        <label className="block text-sm font-medium mb-1">Description</label>
                        <textarea 
                          placeholder="Details of the promise" 
                          className="w-full p-2 border border-gray-300 rounded" 
                          rows={2}
                          value={form.getValues("promise1Description") || ""}
                          onChange={(e) => form.setValue("promise1Description", e.target.value)}
                        />
                      </div>
                      <div className="flex space-x-8 mt-4">
                        <label className="inline-flex items-center cursor-pointer">
                          <input 
                            type="radio" 
                            className="h-5 w-5 text-green-600 border-gray-300 focus:ring-green-500" 
                            name="promise1Status" 
                            value="Fulfilled"
                            checked={form.getValues("promise1Status") === "Fulfilled"} 
                            onChange={() => form.setValue("promise1Status", "Fulfilled")}
                          />
                          <span className="ml-2 flex items-center">
                            <span className="text-green-600 mr-1">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z" stroke="currentColor" strokeWidth="1.5" fill="none" />
                                <path d="M7.75 12.75L10 15.25L16.25 9.75" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                              </svg>
                            </span>
                            <span className="text-sm font-medium">Kept</span>
                          </span>
                        </label>
                        <label className="inline-flex items-center cursor-pointer">
                          <input 
                            type="radio" 
                            className="h-5 w-5 text-yellow-600 border-gray-300 focus:ring-yellow-500" 
                            name="promise1Status" 
                            value="InProgress"
                            checked={form.getValues("promise1Status") === "InProgress"} 
                            onChange={() => form.setValue("promise1Status", "InProgress")}
                          />
                          <span className="ml-2 flex items-center">
                            <span className="text-yellow-600 mr-1">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z" stroke="currentColor" strokeWidth="1.5" fill="none" />
                                <path d="M12 8V13" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                                <path d="M12 16V16.5" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                              </svg>
                            </span>
                            <span className="text-sm font-medium">Partially</span>
                          </span>
                        </label>
                        <label className="inline-flex items-center cursor-pointer">
                          <input 
                            type="radio" 
                            className="h-5 w-5 text-red-600 border-gray-300 focus:ring-red-500" 
                            name="promise1Status" 
                            value="Unfulfilled"
                            checked={form.getValues("promise1Status") === "Unfulfilled"} 
                            onChange={() => form.setValue("promise1Status", "Unfulfilled")}
                          />
                          <span className="ml-2 flex items-center">
                            <span className="text-red-600 mr-1">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z" stroke="currentColor" strokeWidth="1.5" fill="none" />
                                <path d="M15 9L9 15" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                                <path d="M15 15L9 9" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                              </svg>
                            </span>
                            <span className="text-sm font-medium">Not Kept</span>
                          </span>
                        </label>
                      </div>
                    </div>

                    {/* Promise 2 */}
                    <div className="mb-6">
                      <div className="form-control w-full mb-2">
                        <label className="block text-sm font-medium mb-1">Promise</label>
                        <textarea 
                          placeholder="e.g. Will introduce education reform" 
                          className="w-full p-2 border border-gray-300 rounded" 
                          rows={2}
                          value={form.getValues("promise2Title") || ""}
                          onChange={(e) => form.setValue("promise2Title", e.target.value)}
                        />
                      </div>
                      <div className="form-control w-full mb-2">
                        <label className="block text-sm font-medium mb-1">Description</label>
                        <textarea 
                          placeholder="Details of the promise" 
                          className="w-full p-2 border border-gray-300 rounded" 
                          rows={2}
                          value={form.getValues("promise2Description") || ""}
                          onChange={(e) => form.setValue("promise2Description", e.target.value)}
                        />
                      </div>
                      <div className="flex space-x-8 mt-4">
                        <label className="inline-flex items-center cursor-pointer">
                          <input 
                            type="radio" 
                            className="h-5 w-5 text-green-600 border-gray-300 focus:ring-green-500" 
                            name="promise2Status" 
                            value="Fulfilled"
                            checked={form.getValues("promise2Status") === "Fulfilled"} 
                            onChange={() => form.setValue("promise2Status", "Fulfilled")}
                          />
                          <span className="ml-2 flex items-center">
                            <span className="text-green-600 mr-1">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z" stroke="currentColor" strokeWidth="1.5" fill="none" />
                                <path d="M7.75 12.75L10 15.25L16.25 9.75" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                              </svg>
                            </span>
                            <span className="text-sm font-medium">Kept</span>
                          </span>
                        </label>
                        <label className="inline-flex items-center cursor-pointer">
                          <input 
                            type="radio" 
                            className="h-5 w-5 text-yellow-600 border-gray-300 focus:ring-yellow-500" 
                            name="promise2Status" 
                            value="InProgress"
                            checked={form.getValues("promise2Status") === "InProgress"} 
                            onChange={() => form.setValue("promise2Status", "InProgress")}
                          />
                          <span className="ml-2 flex items-center">
                            <span className="text-yellow-600 mr-1">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z" stroke="currentColor" strokeWidth="1.5" fill="none" />
                                <path d="M12 8V13" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                                <path d="M12 16V16.5" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                              </svg>
                            </span>
                            <span className="text-sm font-medium">Partially</span>
                          </span>
                        </label>
                        <label className="inline-flex items-center cursor-pointer">
                          <input 
                            type="radio" 
                            className="h-5 w-5 text-red-600 border-gray-300 focus:ring-red-500" 
                            name="promise2Status" 
                            value="Unfulfilled"
                            checked={form.getValues("promise2Status") === "Unfulfilled"} 
                            onChange={() => form.setValue("promise2Status", "Unfulfilled")}
                          />
                          <span className="ml-2 flex items-center">
                            <span className="text-red-600 mr-1">
                              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z" stroke="currentColor" strokeWidth="1.5" fill="none" />
                                <path d="M15 9L9 15" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                                <path d="M15 15L9 9" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" />
                              </svg>
                            </span>
                            <span className="text-sm font-medium">Not Kept</span>
                          </span>
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
              </TabsContent>
            </Tabs>

            <div className="px-6 py-4 bg-gray-50 flex justify-end space-x-4 border-t">
              <Button
                type="button"
                variant="outline"
                onClick={handleCancel}
                disabled={updatePoliticianMutation.isPending}
              >
                Cancel
              </Button>
              <Button type="submit" disabled={updatePoliticianMutation.isPending}>
                {updatePoliticianMutation.isPending ? "Saving..." : "Save Changes"}
              </Button>
            </div>
          </form>
        </Form>
      </Card>
    </AdminLayout>
  );
};

export default AdminEditPolitician;
